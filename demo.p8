pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init()
    player_x = 8
    player_y = 112
    size_chunk = 8
    sprite_player = 1
    screen_size_x = 128
    screen_size_y = 128

    generate_map()
end

function _update()
    local new_x = player_x
    local new_y = player_y

    if btnp(0) then
        new_x = player_x - size_chunk
    elseif btnp(1) then
        new_x = player_x + size_chunk
    elseif btnp(2) then
        new_y = player_y - size_chunk
    elseif btnp(3) then
        new_y = player_y + size_chunk
    end

    if not colision_detected(new_x, new_y) then
        player_x = new_x
        player_y = new_y
    end
end

function _draw()
    cls()
    map(0, 0, 0, 0, screen_size_x / size_chunk, screen_size_y / size_chunk)
    spr(33, 8 * 8, 0, 1, 1, true, false)
    spr(sprite_player, player_x, player_y)
end

function generate_map()
    for y = 0, screen_size_x / size_chunk - 1 do
        for x = 0, screen_size_y / size_chunk - 1 do
            if x == 0 or x == screen_size_y / size_chunk - 1 or y == 0 or y == screen_size_x / size_chunk - 1 then
                mset(x, y, 32)
            else
                mset(x, y, 16) 
            end
        end
    end
    mset(2, 3, 5)
    mset(7, 0, 33)
end

function colision_detected(new_x, new_y)
    local tile_x = flr(new_x / size_chunk)
    local tile_y = flr(new_y / size_chunk)
    local sprite_colision = mget(tile_x, tile_y)
    
    if sprite_colision == 32 then
        return true
    elseif sprite_colision == 33 then
        return true
    end
    return false
end


__gfx__
00000000000aa0000000000000000000000000000000330000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000aaaa000000000000000000000000000003300000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000a0aa0a00000000000000000000000000008800700000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000a9aaaa9a0000000000000000000000000088880d00000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000aaaaaaaa0000000000000000000000000088880d00000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700aaa009aa0000000000000000000000000008885d00000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000aaaaaa00000000000000000000000000008880d00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000aa0000000000000000000000000000088800d00000000000000000000000000000000000000000000000000000000000000000000000000000000
ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ff5fffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f5ffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ffffff5f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
fffff5ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ffff5fff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00338300555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03333330555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33383333555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
38333338555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03333330555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00044000555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00044000444444490000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00044000444444990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00055500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00064600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f00ff00f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08800880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f088880f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ff0880ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
fff00fff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00338300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33383333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
38333338000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00044000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00044000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00044000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
